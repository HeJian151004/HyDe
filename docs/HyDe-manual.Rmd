---
title: '**HyDe: hybrid detection using phylogenetic invariants**'
output:
  html_document:
    highlight: tango
    theme: lumen
    toc: yes
    toc_depth: 1
date: '`r format(Sys.time(), "%d %B, %Y")`'
---
<style>
p {
  font-size: 125%;
}

li {
  font-size: 115%;
}
</style>

--------

The program HyDe implements the method for hybrid detection described in:

 - Laura S. Kubatko and Julia Chifman. An Invariants-based Method for Efficient Identification of Hybrid Species From Large-scale Genomic Data. *bioRxiv* **doi**: <a href="https://doi.org/10.1101/034348" target="_blank">https://doi.org/10.1101/034348</a>.

# Installation

HyDe is written in C++ with a Python wrapper (`hyde.py`) and can be compiled into an executable (`hyde`) using the `Makefile` provided in the `src/` folder.
Some of the features in HyDe use the C++11 standard, so a compatible compiler is required. There are a few different options for compiling the executable, but the simplest way is to download the HyDe source code, change into the `src/` directory and type `make`:

```bash
# Basic compilation and installation of hyde
cd HyDe/src
make
sudo make install
```

The last command will copy `hyde` and `hyde.py` to `/usr/local/bin` so that they are
available for execution from anywhere on your computer.
If you want to remove it, simply type `sudo make uninstall`.

### Multithreading using OpenMP

HyDe was written with the option to allow multithreading using the OpenMP library. OpenMP is included with the GNU g++ compilers by default, but Apple based C++ compilers no longer support OpenMP. One of the easiest ways to get GNU g++ on a Mac is to install it using Homebrew. The steps for compiling with OpenMP multithreading are almost the same as before but with one slight modification to the `make` command:

```bash
# Compiling with OpenMP, add 'OPENMP=yes' to make step
cd HyDe/src
make OPENMP=yes
sudo make install
```

### Recompiling

If at any point you need to start the compilation process from scratch (e.g., you want to recompile with multithreading), type `make clean` in the `src/` directory. This will remove the `hyde` executable and C++ object files (`*.o`) so that everything can be recompiled in the way that you want.

# Command line interface

HyDe has a simple command line interface that allows users to run the program on their data by passing the relevant files and information using flags.

### Getting help

```bash
hyde.py --help

## usage: hyde.py [-h] -i -m -o -n -t -s [-p] [-b] [-j]
##                [--prefix]
##
## Options for hyde.py
##
## optional arguments:
##   -h, --help           show this help message and exit
##
## required arguments:
##   -i, --infile     name of the data input file
##   -m, --map        map of individuals to taxa
##   -o, --outgroup   name of the outgroup (only one accepted)
##   -n, --num_ind    number of individuals in data matrix
##   -t, --num_taxa   number of taxa (species, OTUs)
##   -s, --num_sites  number of sites in the data matrix
##
## additional arguments:
##   -p, --pvalue     p-value cutoff for test of significance [default=0.05]
##   -b, --bootstrap  number of bootstrap replicates [default=0]
##   -j, --threads    number of threads [default=1]
##   --prefix         prefix appended to output files [default=hyde]
```

# Getting started

The two most important files for running HyDe are the data input file and the map file. The data file is a simple text file that is similar to sequential Phylip format (each individual gets 1 line) but with the first row with the number of individuals and sites removed. There are virtually no restrictions on the length of individual names and they don't all have to be the same length. There does need to be some form of white space (e.g., tab delimited) separating the individual name from the DNA data. The map file is a two column file that maps individuals in the data file to their respective taxa. The individual names are in the first column and need to be in the same order as the data file. Taxon names are in the second column. They don't need to be the same length and only need to be separated from the individual names by white space. Make sure to organize the data and map so that all individuals within the same taxon occur sequentially. Examples of these files can be found in the `examples/` folder.

## Input file

```
Individual1    AGTCGTGCGAGTACAGTGTGAC...
Individual2    AGTCGCGCGAGTACAGTGTGAC...
.
.
.
IndividualN    AGTCGTGCGAGRACAGTGTGAC...
```

## Map file

```
Individual1 Taxon1
Individual2 Taxon1
.
.
.
IndividualN TaxonM
```

## Example analysis with *Sistrurus* rattlesnake data set

```bash
cd HyDe/examples
hyde.py --infile snake-data.txt \
        --map snake-map.txt \
        --num-ind 52 \
        --num-taxa 7 \
        --num-sites 8466 \
        --outgroup out \
        --prefix snake
```

For more details on the analysis carried out by HyDe, see the <a href="http://pblischak.github.io/HyDe/HyDe-notes.html" target="_blank">program notes</a>.
